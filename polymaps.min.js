if(!org)var org={};if(!org.polymaps)org.polymaps={};
(function(o){function Q(){for(var e=0;e<Q.maps.length;e++)Q.maps[e].resize()}function U(e){return 360/Math.PI*Math.atan(Math.exp(e*Math.PI/180))-90}function V(e){return 180/Math.PI*Math.log(Math.tan(Math.PI/4+e*Math.PI/360))}function Z(e,f){if(e.row>f.row){var a=e;e=f;f=a}return{x0:e.column,y0:e.row,x1:f.column,y1:f.row,dx:f.column-e.column,dy:f.row-e.row}}function ca(e,f,a,g,i){a=Math.max(a,Math.floor(f.y0));g=Math.min(g,Math.ceil(f.y1));if(e.x0==f.x0&&e.y0==f.y0?e.x0+f.dy/e.dy*e.dx<f.x1:e.x1-f.dy/
e.dy*e.dx<f.x0){var c=e;e=f;f=c}c=e.dx/e.dy;var d=f.dx/f.dy,m=e.dx>0,n=f.dx<0;for(a=a;a<g;a++){var t=c*Math.max(0,Math.min(e.dy,a+m-e.y0))+e.x0;i(Math.floor(d*Math.max(0,Math.min(f.dy,a+n-f.y0))+f.x0),Math.ceil(t),a)}}function da(e,f,a,g,i,c){var d=Z(e,f);f=Z(f,a);e=Z(a,e);if(d.dy>f.dy){a=d;d=f;f=a}if(d.dy>e.dy){a=d;d=e;e=a}if(f.dy>e.dy){a=f;f=e;e=a}d.dy&&ca(e,d,g,i,c);f.dy&&ca(e,f,g,i,c)}o.version="2.1+2.1";var Y={x:0,y:0};o.id=function(){var e=0;return function(){return++e}}();o.svg=function(e){return document.createElementNS(o.ns.svg,
e)};o.ns={svg:"http://www.w3.org/2000/svg",xlink:"http://www.w3.org/1999/xlink"};o.transform=function(e,f,a,g,i,c){var d={},m,n,t;if(!arguments.length){e=1;f=i=a=0;g=1;c=0}d.zoomFraction=function(l){if(!arguments.length)return n;n=l;m=Math.floor(n+Math.log(Math.sqrt(e*e+f*f+a*a+g*g))/Math.log(2));t=Math.pow(2,-m);return d};d.apply=function(l){var j=Math.pow(2,-l.zoom),q=Math.pow(2,l.zoom-m);return{column:(e*l.column*j+a*l.row*j+i)*q,row:(f*l.column*j+g*l.row*j+c)*q,zoom:l.zoom-m}};d.unapply=function(l){var j=
Math.pow(2,-l.zoom),q=Math.pow(2,l.zoom+m);return{column:(l.column*j*g-l.row*j*a-i*g+c*a)/(e*g-f*a)*q,row:(l.column*j*f-l.row*j*e-i*f+c*e)/(a*f-g*e)*q,zoom:l.zoom+m}};d.toString=function(){return"matrix("+[e*t,f*t,a*t,g*t].join(" ")+" 0 0)"};return d.zoomFraction(0)};o.cache=function(e,f){function a(j){l--;f&&f(j);delete d[j.key];if(j.next)j.next.prev=j.prev;else if(n=j.prev)n.next=null;if(j.prev)j.prev.next=j.next;else if(m=j.next)m.prev=null}function g(){for(var j=n;l>t;j=j.prev){if(!j)break;j.lock||
a(j)}}var i={},c={},d={},m=null,n=null,t=64,l=0;i.peek=function(j){return d[[j.zoom,j.column,j.row].join("/")]};i.load=function(j,q){var y=[j.zoom,j.column,j.row].join("/"),x=d[y];if(x){if(x.prev){if(x.prev.next=x.next)x.next.prev=x.prev;else n=x.prev;x.prev=null;x.next=m;m=m.prev=x}x.lock=1;return c[y]=x}x={key:y,column:j.column,row:j.row,zoom:j.zoom,next:m,prev:null,lock:1};e.call(null,x,q);c[y]=d[y]=x;if(m)m.prev=x;else n=x;m=x;l++;return x};i.unload=function(j){if(!(j in c))return false;var q=
c[j];q.lock=0;delete c[j];q.request&&q.request.abort(false)&&a(q);return q};i.locks=function(){return c};i.size=function(j){if(!arguments.length)return t;t=j;g();return i};i.flush=function(){g();return i};i.clear=function(){for(var j in d){var q=d[j];q.request&&q.request.abort(false);f&&f(d[j]);if(q.lock){q.lock=0;q.element.parentNode.removeChild(q.element)}}c={};d={};m=n=null;l=0;return i};return i};o.url=function(e){function f(g){var i=g.zoom<0?1:1<<g.zoom,c=g.column%i;if(c<0)c+=i;return e.replace(/{(.)}/g,
function(d,m){switch(m){case "S":return a[(Math.abs(g.zoom)+g.row+c)%a.length];case "Z":return g.zoom;case "X":return c;case "Y":return g.row;case "B":var n=o.map.coordinateLocation({row:g.row,column:c,zoom:g.zoom}),t=o.map.coordinateLocation({row:g.row+1,column:c+1,zoom:g.zoom}),l=Math.ceil(Math.log(g.zoom)/Math.LN2);return t.lat.toFixed(l)+","+n.lon.toFixed(l)+","+n.lat.toFixed(l)+","+t.lon.toFixed(l)}return m})}var a=[];f.template=function(g){if(!arguments.length)return e;e=g;return f};f.hosts=
function(g){if(!arguments.length)return a;a=g;return f};return f};o.dispatch=function(e){var f={};e.on=function(a,g){for(var i=f[a]||(f[a]=[]),c=0;c<i.length;c++)if(i[c].handler==g)return e;i.push({handler:g,on:true});return e};e.off=function(a,g){var i=f[a];if(i)for(var c=0;c<i.length;c++){var d=i[c];if(d.handler==g){d.on=false;i.splice(c,1);break}}return e};return function(a){var g=f[a.type];if(g){g=g.slice();for(var i=0;i<g.length;i++){var c=g[i];c.on&&c.handler.call(e,a)}}}};o.queue=function(){function e(){if(!(i>=
c||!g.length)){i++;g.pop()()}}function f(d){for(var m=0;m<g.length;m++)if(g[m]==d){g.splice(m,1);return true}return false}function a(d,m,n){function t(){l=new XMLHttpRequest;n&&l.overrideMimeType(n);l.open("GET",d,true);l.onreadystatechange=function(){if(l.readyState==4){i--;l.status<300&&m(l);e()}};l.send(null)}var l;g.push(t);e();return{abort:function(j){if(f(t))return true;if(j&&l){l.abort();return true}return false}}}var g=[],i=0,c=6;return{text:function(d,m,n){return a(d,function(t){t.responseText&&
m(t.responseText)},n)},xml:function(d,m){return a(d,function(n){n.responseXML&&m(n.responseXML)},"application/xml")},json:function(d,m){return a(d,function(n){n.responseText&&m(JSON.parse(n.responseText))},"application/json")},image:function(d,m,n){function t(){l=document.createElement("img");l.onerror=function(){i--;e()};l.onload=function(){i--;n(l);e()};l.src=m;d.setAttributeNS(o.ns.xlink,"href",m)}var l;g.push(t);e();return{abort:function(j){if(f(t))return true;if(j&&l){l.src="about:";return true}return false}}}}}();
o.map=function(){function e(){if(q)if(t<q[0])t=q[0];else if(t>q[1])t=q[1];l=t-(t=Math.round(t));j=Math.pow(2,l)}function f(){if(r){var k=45/Math.pow(2,t+l-3),s=Math.max(Math.abs(C*d.x+x*d.y),Math.abs(h*d.x+F*d.y)),z=U(w-s*k/m.y);s=U(u+s*k/m.y);n.lat=Math.max(z,Math.min(s,n.lat));z=Math.max(Math.abs(C*d.y+x*d.x),Math.abs(h*d.y+F*d.x));n.lon=Math.max(r[0].lon-z*k/m.x,Math.min(r[1].lon+z*k/m.x,n.lon))}}var a={},g,i,c=Y,d=Y,m={x:256,y:256},n={lat:37.76487,lon:-122.41948},t=12,l=0,j=1,q=[1,18],y=0,x=1,
C=0,F=1,h=0,w=-180,u=180,r=[{lat:U(w),lon:-Infinity},{lat:U(u),lon:Infinity}];a.locationCoordinate=function(k){k=o.map.locationCoordinate(k);var s=Math.pow(2,t);k.column*=s;k.row*=s;k.zoom+=t;return k};a.coordinateLocation=o.map.coordinateLocation;a.coordinatePoint=function(k,s){var z=Math.pow(2,t-s.zoom),E=Math.pow(2,t-k.zoom),A=(s.column*z-k.column*E)*m.x*j;z=(s.row*z-k.row*E)*m.y*j;return{x:d.x+x*A-C*z,y:d.y+C*A+x*z}};a.pointCoordinate=function(k,s){var z=Math.pow(2,t-k.zoom),E=(s.x-d.x)/j,A=(s.y-
d.y)/j;return{column:k.column*z+(F*E-h*A)/m.x,row:k.row*z+(h*E+F*A)/m.y,zoom:t}};a.locationPoint=function(k){var s=Math.pow(2,t+l-3)/45,z=(k.lon-n.lon)*s*m.x;k=(V(n.lat)-V(k.lat))*s*m.y;return{x:d.x+x*z-C*k,y:d.y+C*z+x*k}};a.pointLocation=function(k){var s=45/Math.pow(2,t+l-3),z=(k.x-d.x)*s;k=(k.y-d.y)*s;return{lon:n.lon+(F*z-h*k)/m.x,lat:U(V(n.lat)-(h*z+F*k)/m.y)}};var B=o.svg("rect");B.setAttribute("visibility","hidden");B.setAttribute("pointer-events","all");a.container=function(k){if(!arguments.length)return g;
g=k;g.setAttribute("class","map");g.appendChild(B);return a.resize()};a.focusableParent=function(){for(var k=g;k;k=k.parentNode)if(k.tabIndex>=0)return k;return window};a.mouse=function(k){var s=(g.ownerSVGElement||g).createSVGPoint();if($<0&&(window.scrollX||window.scrollY)){var z=document.body.appendChild(o.svg("svg"));z.style.position="absolute";z.style.top=z.style.left="0px";var E=z.getScreenCTM();$=!(E.f||E.e);document.body.removeChild(z)}if($){s.x=k.pageX;s.y=k.pageY}else{s.x=k.clientX;s.y=
k.clientY}return s.matrixTransform(g.getScreenCTM().inverse())};a.size=function(k){if(!arguments.length)return c;i=k;return a.resize()};a.resize=function(){if(i){c=i;Q.remove(a)}else{var k=g.ownerSVGElement||g;if(k.offsetWidth==null){B.setAttribute("width","100%");B.setAttribute("height","100%");k=B}b=k.getBoundingClientRect();c={x:b.width,y:b.height};Q.add(a)}B.setAttribute("width",c.x);B.setAttribute("height",c.y);d={x:c.x/2,y:c.y/2};f();a.dispatch({type:"resize"});return a};a.tileSize=function(k){if(!arguments.length)return m;
m=k;a.dispatch({type:"move"});return a};a.center=function(k){if(!arguments.length)return n;n=k;f();a.dispatch({type:"move"});return a};a.panBy=function(k){var s=45/Math.pow(2,t+l-3),z=k.x*s;k=k.y*s;return a.center({lon:n.lon+(h*k-F*z)/m.x,lat:U(V(n.lat)+(h*z+F*k)/m.y)})};a.centerRange=function(k){if(!arguments.length)return r;if(r=k){w=r[0].lat>-90?V(r[0].lat):-Infinity;u=r[0].lat<90?V(r[1].lat):Infinity}else{w=-Infinity;u=Infinity}f();a.dispatch({type:"move"});return a};a.zoom=function(k){if(!arguments.length)return t+
l;t=k;e();return a.center(n)};a.zoomBy=function(k,s,z){if(arguments.length<2)return a.zoom(t+l+k);if(arguments.length<3)z=a.pointLocation(s);t=t+l+k;e();var E=a.locationPoint(z);return a.panBy({x:s.x-E.x,y:s.y-E.y})};a.zoomRange=function(k){if(!arguments.length)return q;q=k;return a.zoom(t+l)};a.extent=function(k){if(!arguments.length)return[a.pointLocation({x:0,y:c.y}),a.pointLocation({x:c.x,y:0})];var s=a.locationPoint(k[0]),z=a.locationPoint(k[1]),E=Math.max((z.x-s.x)/c.x,(s.y-z.y)/c.y);s=a.pointLocation({x:(s.x+
z.x)/2,y:(s.y+z.y)/2});t=t+l-Math.log(E)/Math.log(2);e();return a.center(s)};a.angle=function(k){if(!arguments.length)return y;y=k;x=Math.cos(y);C=Math.sin(y);F=Math.cos(-y);h=Math.sin(-y);f();a.dispatch({type:"move"});return a};a.add=function(k){k.map(a);return a};a.remove=function(k){k.map(null);return a};a.dispatch=o.dispatch(a);return a};Q.maps=[];Q.add=function(e){for(var f=0;f<Q.maps.length;f++)if(Q.maps[f]==e)return;Q.maps.push(e)};Q.remove=function(e){for(var f=0;f<Q.maps.length;f++)if(Q.maps[f]==
e){Q.maps.splice(f,1);return}};window.addEventListener("resize",Q,false);o.map.locationCoordinate=function(e){var f=1/360;return{column:(e.lon+180)*f,row:(180-V(e.lat))*f,zoom:0}};o.map.coordinateLocation=function(e){var f=45/Math.pow(2,e.zoom-3);return{lon:f*e.column-180,lat:U(180-f*e.row)}};var $=/WebKit/.test(navigator.userAgent)?-1:0;o.layer=function(e,f){function a(h){for(var w=C[0].nextSibling;x<h;x++){q.insertBefore(C[-4],w);q.insertBefore(C[2],w);q.insertBefore(C[1],w);for(var u=C[-4],r=-4;r<
2;)C[r]=C[++r];C[r]=u}}function g(h){for(var w=C[0].nextSibling;x>h;x--){q.insertBefore(C[-1],w);q.insertBefore(C[2],C[-4]);for(var u=C[2],r=2;r>-4;)C[r]=C[--r];C[r]=u}}function i(){function h(L){var H=L.zoom,R=H<0?1:1<<H,S=L.column%R,v=L.row;if(S<0)S+=R;return{locationPoint:function(D){D=o.map.locationCoordinate(D);var G=Math.pow(2,H-D.zoom);return{x:z.x*(G*D.column-S),y:z.y*(G*D.row-v)}}}}function w(L,H,R){var S=O.zoom,v=2-T,D=4+T;for(L=L;L<H;L++){var G=d.load({column:L,row:R,zoom:S},h);if(!G.ready&&
!(G.key in N)){G.proxyRefs={};for(var J,K,M,P=1;P<=v;P++){K=true;for(var W=0,ea=1<<P;W<=ea;W++)for(var aa=0;aa<=ea;aa++)if((M=d.peek(J={column:(L<<P)+aa,row:(R<<P)+W,zoom:S+P}))&&M.ready){N[M.key]=d.load(J);M.proxyCount++;G.proxyRefs[M.key]=M}else K=false;if(K)break}if(!K)for(P=1;P<=D;P++)if((M=d.peek(J={column:L>>P,row:R>>P,zoom:S-P}))&&M.ready){N[M.key]=d.load(J);M.proxyCount++;G.proxyRefs[M.key]=M;break}}N[G.key]=G}}var u=c.map(),r=u.zoom(),B=r-(r=Math.round(r)),k=u.size(),s=u.angle(),z=u.tileSize(),
E=u.locationCoordinate(u.center());if(x!=r){if(x<r)a(r);else if(x>r)g(r);else x=r;for(var A=-4;A<=2;A++){var X=C[A];X.setAttribute("class","zoom"+(A<0?"":"+")+A+" zoom"+(r+A));X.setAttribute("transform","scale("+Math.pow(2,-A)+")")}}q.setAttribute("transform","translate("+k.x/2+","+k.y/2+")"+(s?"rotate("+s/Math.PI*180+")":"")+(B?"scale("+Math.pow(2,B)+")":"")+(y?y.zoomFraction(B):""));var O=u.pointCoordinate(E,Y);A=u.pointCoordinate(E,{x:k.x,y:0});r=u.pointCoordinate(E,k);u=u.pointCoordinate(E,{x:0,
y:k.y});if(!B&&!s&&!y){E.column=(Math.round(z.x*E.column)+(k.x&1)/2)/z.x;E.row=(Math.round(z.y*E.row)+(k.y&1)/2)/z.y}if(y){O=y.unapply(O);A=y.unapply(A);r=y.unapply(r);u=y.unapply(u);E=y.unapply(E)}var T=t?t(O.zoom)-O.zoom:0;if(T){s=Math.pow(2,T);O.column*=s;O.row*=s;A.column*=s;A.row*=s;r.column*=s;r.row*=s;u.column*=s;u.row*=s;O.zoom=A.zoom=r.zoom=u.zoom+=T}B=d.locks();var N={};for(var I in B)B[I].proxyCount=0;if(n&&T>-5&&T<3){s=O.zoom<0?1:1<<O.zoom;if(m){da(O,A,r,0,s,w);da(r,u,O,0,s,w)}else{k=
Math.floor((O.column+r.column)/2);s=Math.max(0,Math.min(s-1,Math.floor((A.row+u.row)/2)));A=Math.min(4,O.zoom);k=k>>A<<A;s=s>>A<<A;w(k,k+1,s)}}for(I in N){A=N[I];s=Math.pow(2,A.level=A.zoom-E.zoom);k=z.x*(A.column-E.column*s);s=z.y*(A.row-E.row*s);A.element.setAttribute("transform","translate("+k+","+s+")")}for(I in B)if(!(I in N)){A=d.unload(I);A.element.parentNode.removeChild(A.element);delete A.proxyRefs}for(I in N){A=N[I];if(A.element.parentNode!=C[A.level]){C[A.level].appendChild(A.element);
c.show&&c.show(A)}}d.flush()}var c={},d=c.cache=o.cache(e,f).size(512),m=true,n=true,t,l,j,q=o.svg("g"),y,x,C={};q.setAttribute("class","layer");for(var F=-4;F<=-1;F++)C[F]=q.appendChild(o.svg("g"));for(F=2;F>=1;F--)C[F]=q.appendChild(o.svg("g"));C[0]=q.appendChild(o.svg("g"));c.map=function(h){if(!arguments.length)return j;if(j){if(j==h){q.parentNode.appendChild(q);return c}j.off("move",i).off("resize",i);q.parentNode.removeChild(q)}if(j=h){j.container().appendChild(q);c.init&&c.init(q);j.on("move",
i).on("resize",i);i()}return c};c.container=function(){return q};c.id=function(h){if(!arguments.length)return l;l=h;q.setAttribute("id",h);return c};c.visible=function(h){if(!arguments.length)return n;(n=h)?q.removeAttribute("visibility"):q.setAttribute("visibility","hidden");j&&i();return c};c.transform=function(h){if(!arguments.length)return y;y=h;j&&i();return c};c.zoom=function(h){if(!arguments.length)return t;t=typeof h=="function"||h==null?h:function(){return h};j&&i();return c};c.tile=function(h){if(!arguments.length)return m;
m=h;j&&i();return c};c.reload=function(){d.clear();j&&i();return c};c.dispatch=o.dispatch(c);c.on("load",function(h){if(h.tile.proxyRefs){for(var w in h.tile.proxyRefs){var u=h.tile.proxyRefs[w];--u.proxyCount<=0&&d.unload(w)&&u.element.parentNode.removeChild(u.element)}delete h.tile.proxyRefs}});return c};o.image=function(){var e=o.layer(function(a){var g=a.element=o.svg("image"),i=e.map().tileSize();g.setAttribute("preserveAspectRatio","none");g.setAttribute("width",i.x);g.setAttribute("height",
i.y);g.setAttribute("opacity",0);if(typeof f=="function")a.request=o.queue.image(g,f(a),function(c){delete a.request;a.ready=true;a.img=c;g.removeAttribute("opacity");e.dispatch({type:"load",tile:a})});else{a.ready=true;g.setAttributeNS(o.ns.xlink,"href",f);e.dispatch({type:"load",tile:a})}},function(a){a.request&&a.request.abort(true)}),f="about:blank";e.url=function(a){if(!arguments.length)return f;f=typeof a=="string"&&/{.}/.test(a)?o.url(a):a;return e.reload()};return e};o.geoJson=function(e){function f(h,
w){return h&&h.type in C&&C[h.type](h,w)}function a(h,w){var u=w({lat:h[1],lon:h[0]}),r=o.svg("circle");r.setAttribute("r",4.5);r.setAttribute("cx",u.x);r.setAttribute("cy",u.y);return r}function g(h,w,u,r){r.push("M");for(var B=0;B<h.length-w;B++){p=u({lat:h[B][1],lon:h[B][0]});r.push(p.x);r.push(",");r.push(p.y);r.push("L")}r.pop()}function i(h,w,u,r){for(var B=0;B<h.length;B++)g(h[B],w,u,r);w&&r.push("Z")}function c(h,w,u,r){for(var B=[],k=0;k<w.length;k++)h(w[k],u,r,B);if(B.length){h=o.svg("path");
h.setAttribute("d",B.join(""));return h}}var d=o.layer(function(h,w){function u(B){var k=[];if(B.next)h.request=e(B.next.href,u);switch(B.type){case "FeatureCollection":for(var s=0;s<B.features.length;s++){var z=B.features[s],E=f(z.geometry,w.locationPoint);E&&k.push({element:r.appendChild(E),data:z})}break;case "Feature":(E=f(B.geometry,w.locationPoint))&&k.push({element:r.appendChild(E),data:B});break;default:(E=f(B,w.locationPoint))&&k.push({element:r.appendChild(E),data:{type:"Feature",geometry:B}});
break}h.ready=true;k.push.apply(y[h.key]||(y[h.key]=[]),k);d.dispatch({type:"load",tile:h,features:k})}var r=h.element=o.svg("g");w=w(h);if(x)u({type:"FeatureCollection",features:x});else h.request=e(typeof n=="function"?n(h):n,u);l&&r.setAttribute("clip-path","url(#"+l+")")},function(h){h.request&&h.request.abort(true);delete y[h.key]}),m=d.container(),n="about:blank",t=true,l,j,q,y={},x;m.setAttribute("fill-rule","evenodd");if(!arguments.length)e=o.queue.json;var C={Point:function(h,w){return a(h.coordinates,
w)},MultiPoint:function(h,w){for(var u=o.svg("g"),r=0;r<h.coordinates.length;r++)u.appendChild(a(h.coordinates[r],w));return u},LineString:function(h,w){return c(g,[h.coordinates],0,w)},MultiLineString:function(h,w){return c(g,h.coordinates,0,w)},Polygon:function(h,w){return c(i,[h.coordinates],1,w)},MultiPolygon:function(h,w){return c(i,h.coordinates||h.coords,1,w)},GeometryCollection:function(h,w){for(var u=o.svg("g"),r=0;r<h.geometries.length;r++){var B=f(h.geometries[r],w);B&&u.appendChild(B)}return u}};
d.url=function(h){if(!arguments.length)return n;n=typeof h=="string"&&/{.}/.test(h)?o.url(h):h;typeof n=="string"&&d.tile(false);return d.reload()};d.features=function(h){if(!arguments.length)return x;h&&d.tile(false);x=h;return d.reload()};d.clip=function(h){if(!arguments.length)return t;t=h;return d};var F=d.map;d.map=function(h){if(h)if(t&&d.tile()){if(!j){j=m.insertBefore(o.svg("clipPath"),m.firstChild);q=j.appendChild(o.svg("rect"));j.setAttribute("id",l="org.polymaps."+o.id())}var w=h.tileSize();
q.setAttribute("width",w.x);q.setAttribute("height",w.y)}else if(j){m.removeChild(j);j=q=l=null}return F.apply(d,arguments)};d.show=function(h){d.dispatch({type:"show",tile:h,features:y[h.key]||[]});return d};d.reshow=function(){var h=d.cache.locks();for(var w in h)d.show(h[w]);return d};return d};o.dblclick=function(){function e(c){var d=g.zoom();d=c.shiftKey?Math.ceil(d)-d-1:1-d+Math.floor(d);a==="mouse"?g.zoomBy(d,g.mouse(c)):g.zoomBy(d)}var f={},a="mouse",g,i;f.zoom=function(c){if(!arguments.length)return a;
a=c;return f};f.map=function(c){if(!arguments.length)return g;if(g){i.removeEventListener("dblclick",e,false);i=null}if(g=c){i=g.container();i.addEventListener("dblclick",e,false)}return f};return f};o.drag=function(){function e(d){if(!d.shiftKey){c={x:d.clientX,y:d.clientY};g.focusableParent().focus();d.preventDefault();document.body.style.setProperty("cursor","move",null)}}function f(d){if(c){g.panBy({x:d.clientX-c.x,y:d.clientY-c.y});c.x=d.clientX;c.y=d.clientY}}var a={},g,i,c;a.map=function(d){if(!arguments.length)return g;
if(g){i.removeEventListener("mousedown",e,false);i=null}if(g=d){i=g.container();i.addEventListener("mousedown",e,false)}return a};window.addEventListener("mousemove",f,false);window.addEventListener("mouseup",function(d){if(c){f(d);c=null;document.body.style.removeProperty("cursor")}},false);return a};o.wheel=function(){function e(){m=null}function f(l){var j=(l.wheelDelta/120||-l.detail)*0.1,q;if(ba<0){q=Date.now();var y=q-i;if(y>9&&Math.abs(l.wheelDelta)/y>=50)ba=1;i=q}if(ba==1)j*=0.03;if(!c&&j){q=
Date.now();if(q-g>200){j=j>0?+1:-1;g=q}else j=0}if(j)switch(d){case "mouse":q=n.mouse(l);m||(m=n.pointLocation(q));n.off("move",e).zoomBy(j,q,m).on("move",e);break;case "location":n.zoomBy(j,n.locationPoint(m),m);break;default:n.zoomBy(j);break}l.preventDefault();return false}var a={},g=0,i=0,c=true,d="mouse",m,n,t;a.smooth=function(l){if(!arguments.length)return c;c=l;return a};a.zoom=function(l,j){if(!arguments.length)return d;d=l;m=j;if(n)d=="mouse"?n.on("move",e):n.off("move",e);return a};a.map=
function(l){if(!arguments.length)return n;if(n){t.removeEventListener("mousemove",e,false);t.removeEventListener("mousewheel",f,false);t.removeEventListener("DOMMouseScroll",f,false);t=null;n.off("move",e)}if(n=l){d=="mouse"&&n.on("move",e);t=n.container();t.addEventListener("mousemove",e,false);t.addEventListener("mousewheel",f,false);t.addEventListener("DOMMouseScroll",f,false)}return a};return a};var ba=/WebKit\/533/.test(navigator.userAgent)?-1:0;o.arrow=function(){function e(y){if(!(y.ctrlKey||
y.altKey||y.metaKey)){var x=Date.now(),C=0,F=0;switch(y.keyCode){case 37:if(!c.left){d=x;c.left=1;c.right||(C=l)}break;case 39:if(!c.right){d=x;c.right=1;c.left||(C=-l)}break;case 38:if(!c.up){d=x;c.up=1;c.down||(F=l)}break;case 40:if(!c.down){d=x;c.down=1;c.up||(F=-l)}break;default:return}if(C||F)j.panBy({x:C,y:F});if(!m&&c.left|c.right|c.up|c.down)m=setInterval(g,t);y.preventDefault()}}function f(y){d=Date.now();switch(y.keyCode){case 37:c.left=0;break;case 39:c.right=0;break;case 38:c.up=0;break;
case 40:c.down=0;break;default:return}if(m&&!(c.left|c.right|c.up|c.down))m=clearInterval(m);y.preventDefault()}function a(y){switch(y.charCode){case 45:case 95:j.zoom(Math.ceil(j.zoom())-1);break;case 43:case 61:j.zoom(Math.floor(j.zoom())+1);break;default:return}y.preventDefault()}function g(){if(j)if(!(Date.now()<d+n)){var y=(c.left-c.right)*l,x=(c.up-c.down)*l;if(y||x)j.panBy({x:y,y:x})}}var i={},c={left:0,right:0,up:0,down:0},d=0,m,n=250,t=50,l=16,j,q;i.map=function(y){if(!arguments.length)return j;
if(j){q.removeEventListener("keypress",a,false);q.removeEventListener("keydown",e,false);q.removeEventListener("keyup",f,false);q=null}if(j=y){q=j.focusableParent();q.addEventListener("keypress",a,false);q.addEventListener("keydown",e,false);q.addEventListener("keyup",f,false)}return i};i.speed=function(y){if(!arguments.length)return l;l=y;return i};return i};o.hash=function(){function e(){var d=c.center(),m=c.zoom(),n=Math.max(0,Math.ceil(Math.log(m)/Math.LN2));d="#"+m.toFixed(2)+"/"+d.lat.toFixed(n)+
"/"+d.lon.toFixed(n);if(g!==d)location.replace(g=d)}function f(){if(location.hash!==g){var d=(g=location.hash).substring(1).split("/").map(Number);if(d.length<3||d.some(isNaN))e();else{var m=c.size();c.zoomBy(d[0]-c.zoom(),{x:m.x/2,y:m.y/2},{lat:Math.min(i,Math.max(-i,d[1])),lon:d[2]})}}}var a={},g,i=89.99999999,c;a.map=function(d){if(!arguments.length)return c;if(c){c.off("move",e);window.removeEventListener("hashchange",f,false)}if(c=d){c.on("move",e);window.addEventListener("hashchange",f,false);
location.hash?f():e()}return a};return a};o.interact=function(){var e={},f=o.drag(),a=o.wheel(),g=o.dblclick(),i=o.arrow();e.map=function(c){f.map(c);a.map(c);g.map(c);i.map(c);return e};return e};o.compass=function(){function e(v){h.setAttribute("class","compass active");O||(O=setInterval(f,s));T&&H.panBy(T);B=Date.now();return l(v)}function f(){T&&Date.now()>B+k&&H.panBy(T)}function a(v){if(v.shiftKey){I={x0:H.mouse(v)};H.focusableParent().focus();return l(v)}}function g(v){if(I){I.x1=H.mouse(v);
L.setAttribute("x",Math.min(I.x0.x,I.x1.x));L.setAttribute("y",Math.min(I.x0.y,I.x1.y));L.setAttribute("width",Math.abs(I.x0.x-I.x1.x));L.setAttribute("height",Math.abs(I.x0.y-I.x1.y));L.removeAttribute("display")}}function i(){h.setAttribute("class","compass");if(I){if(I.x1){H.extent([H.pointLocation({x:Math.min(I.x0.x,I.x1.x),y:Math.max(I.x0.y,I.x1.y)}),H.pointLocation({x:Math.max(I.x0.x,I.x1.x),y:Math.min(I.x0.y,I.x1.y)})]);L.setAttribute("display","none")}I=null}if(O){clearInterval(O);O=0}}function c(v){return function(){v?
this.setAttribute("class","active"):this.removeAttribute("class");T=v}}function d(v){return function(D){h.setAttribute("class","compass active");var G=H.zoom();H.zoom(v<0?Math.ceil(G)-1:Math.floor(G)+1);return l(D)}}function m(v){return function(D){H.zoom(v);return l(D)}}function n(){this.setAttribute("class","active")}function t(){this.removeAttribute("class")}function l(v){v.stopPropagation();v.preventDefault();return false}function j(v){var D=Math.SQRT1_2*u,G=u*0.7,J=u*0.2,K=o.svg("g"),M=K.appendChild(o.svg("path")),
P=K.appendChild(o.svg("path"));M.setAttribute("class","direction");M.setAttribute("pointer-events","all");M.setAttribute("d","M0,0L"+D+","+D+"A"+u+","+u+" 0 0,1 "+-D+","+D+"Z");P.setAttribute("class","chevron");P.setAttribute("d","M"+J+","+(G-J)+"L0,"+G+" "+-J+","+(G-J));P.setAttribute("pointer-events","none");K.addEventListener("mousedown",e,false);K.addEventListener("mouseover",c(v),false);K.addEventListener("mouseout",c(null),false);K.addEventListener("dblclick",l,false);return K}function q(v){var D=
u*0.4,G=D/2,J=o.svg("g"),K=J.appendChild(o.svg("path")),M=J.appendChild(o.svg("path")),P=J.appendChild(o.svg("path")),W=J.appendChild(o.svg("path"));K.setAttribute("class","back");K.setAttribute("d","M"+-D+",0V"+-D+"A"+D+","+D+" 0 1,1 "+D+","+-D+"V0Z");M.setAttribute("class","direction");M.setAttribute("d",K.getAttribute("d"));P.setAttribute("class","chevron");P.setAttribute("d","M"+-G+","+-D+"H"+G+(v>0?"M0,"+(-D-G)+"V"+-G:""));W.setAttribute("class","fore");W.setAttribute("fill","none");W.setAttribute("d",
K.getAttribute("d"));J.addEventListener("mousedown",d(v),false);J.addEventListener("mouseover",n,false);J.addEventListener("mouseout",t,false);J.addEventListener("dblclick",l,false);return J}function y(v){var D=u*0.2,G=u*0.4,J=o.svg("g"),K=J.appendChild(o.svg("rect")),M=J.appendChild(o.svg("path"));K.setAttribute("pointer-events","all");K.setAttribute("fill","none");K.setAttribute("x",-G);K.setAttribute("y",-0.75*G);K.setAttribute("width",2*G);K.setAttribute("height",1.5*G);M.setAttribute("class",
"chevron");M.setAttribute("d","M"+-D+",0H"+D);J.addEventListener("mousedown",m(v),false);J.addEventListener("dblclick",l,false);return J}function x(){var v=u+6,D=v,G=H.size();switch(z){case "top-left":break;case "top-right":v=G.x-v;break;case "bottom-left":D=G.y-D;break;case "bottom-right":v=G.x-v;D=G.y-D;break}v="translate("+v+","+D+")";N&&N.setAttribute("transform",v);A&&A.setAttribute("transform",v);for(var J in w)J==H.zoom()?w[J].setAttribute("class","active"):w[J].removeAttribute("class")}function C(){for(;h.lastChild;)h.removeChild(h.lastChild);
h.appendChild(L);if(X!="none"){N=h.appendChild(o.svg("g"));N.setAttribute("class","pan");var v=N.appendChild(o.svg("circle"));v.setAttribute("class","back");v.setAttribute("r",u);N.appendChild(j({x:0,y:-r})).setAttribute("transform","rotate(0)");N.appendChild(j({x:r,y:0})).setAttribute("transform","rotate(90)");N.appendChild(j({x:0,y:r})).setAttribute("transform","rotate(180)");N.appendChild(j({x:-r,y:0})).setAttribute("transform","rotate(270)");v=N.appendChild(o.svg("circle"));v.setAttribute("fill",
"none");v.setAttribute("class","fore");v.setAttribute("r",u)}else N=null;if(E!="none"){A=h.appendChild(o.svg("g"));A.setAttribute("class","zoom");v=-0.5;if(E=="big"){w={};var D=H.zoomRange()[0];for(v=0;D<=H.zoomRange()[1];D++,v++)(w[D]=A.appendChild(y(D))).setAttribute("transform","translate(0,"+-(v+0.75)*u*0.4+")")}D=X=="none"?0.4:2;A.setAttribute("transform","translate(0,"+u*(/^top-/.test(z)?D+(v+0.5)*0.4:-D)+")");A.appendChild(q(+1)).setAttribute("transform","translate(0,"+-(v+0.5)*u*0.4+")");
A.appendChild(q(-1)).setAttribute("transform","scale(-1)")}else A=null;x()}var F={},h=o.svg("g"),w={},u=30,r=16,B=0,k=250,s=50,z="top-left",E="small",A,X="small",O,T,N,I,L=o.svg("rect"),H,R,S;h.setAttribute("class","compass");L.setAttribute("class","back fore");L.setAttribute("pointer-events","none");L.setAttribute("display","none");F.radius=function(v){if(!arguments.length)return u;u=v;H&&C();return F};F.speed=function(v){if(!arguments.length)return u;r=v;return F};F.position=function(v){if(!arguments.length)return z;
z=v;H&&C();return F};F.pan=function(v){if(!arguments.length)return X;X=v;H&&C();return F};F.zoom=function(v){if(!arguments.length)return E;E=v;H&&C();return F};F.map=function(v){if(!arguments.length)return H;if(H){R.removeEventListener("mousedown",a,false);R.removeChild(h);R=null;S.removeEventListener("mousemove",g,false);S.removeEventListener("mouseup",i,false);S=null;H.off("move",x).off("resize",x)}if(H=v){R=H.container();R.appendChild(h);R.addEventListener("mousedown",a,false);S=R.ownerDocument.defaultView;
S.addEventListener("mousemove",g,false);S.addEventListener("mouseup",i,false);H.on("move",x).on("resize",x);C()}return F};return F};o.grid=function(){function e(){var i=g.firstChild,c=a.size(),d=a.pointLocation(Y);a.pointLocation(c);var m=Math.pow(2,4-Math.round(a.zoom()));d.lat=Math.floor(d.lat/m)*m;d.lon=Math.ceil(d.lon/m)*m;for(var n;(n=a.locationPoint(d).x)<=c.x;d.lon+=m){i||(i=g.appendChild(o.svg("line")));i.setAttribute("x1",n);i.setAttribute("x2",n);i.setAttribute("y1",0);i.setAttribute("y2",
c.y);i=i.nextSibling}for(;(n=a.locationPoint(d).y)<=c.y;d.lat-=m){i||(i=g.appendChild(o.svg("line")));i.setAttribute("y1",n);i.setAttribute("y2",n);i.setAttribute("x1",0);i.setAttribute("x2",c.x);i=i.nextSibling}for(;i;){c=i.nextSibling;g.removeChild(i);i=c}}var f={},a,g=o.svg("g");g.setAttribute("class","grid");f.map=function(i){if(!arguments.length)return a;if(a){g.parentNode.removeChild(g);a.off("move",e).off("resize",e)}if(a=i){a.on("move",e).on("resize",e);a.container().appendChild(g);a.dispatch({type:"move"})}return f};
return f}})(org.polymaps);
