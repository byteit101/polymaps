if(!org)var org={};if(!org.polymaps)org.polymaps={};
(function(q){function M(){for(var d=0;d<M.maps.length;d++)M.maps[d].resize()}function Q(d){return 360/Math.PI*Math.atan(Math.exp(d*Math.PI/180))-90}function R(d){return 180/Math.PI*Math.log(Math.tan(Math.PI/4+d*Math.PI/360))}function U(d,g){if(d.row>g.row){var a=d;d=g;g=a}return{x0:d.column,y0:d.row,x1:g.column,y1:g.row,dx:g.column-d.column,dy:g.row-d.row}}function Z(d,g,a,c,j){a=Math.max(a,Math.floor(g.y0));c=Math.min(c,Math.ceil(g.y1));if(d.x0==g.x0&&d.y0==g.y0?d.x0+g.dy/d.dy*d.dx<g.x1:d.x1-g.dy/
d.dy*d.dx<g.x0){var h=d;d=g;g=h}h=d.dx/d.dy;var f=g.dx/g.dy,k=d.dx>0,o=g.dx<0;for(a=a;a<c;a++){var r=h*Math.max(0,Math.min(d.dy,a+k-d.y0))+d.x0;j(Math.floor(f*Math.max(0,Math.min(g.dy,a+o-g.y0))+g.x0),Math.ceil(r),a)}}function $(d,g,a,c,j,h){var f=U(d,g);g=U(g,a);d=U(a,d);if(f.dy>g.dy){a=f;f=g;g=a}if(f.dy>d.dy){a=f;f=d;d=a}if(g.dy>d.dy){a=g;g=d;d=a}f.dy&&Z(d,f,c,j,h);g.dy&&Z(d,g,c,j,h)}q.version="2.0+1.3+1";var S={x:0,y:0};q.id=function(){var d=0;return function(){return++d}}();q.svg=function(d){return document.createElementNS(q.ns.svg,
d)};q.ns={svg:"http://www.w3.org/2000/svg",xlink:"http://www.w3.org/1999/xlink"};q.transform=function(d,g,a,c,j,h){var f={},k,o,r;if(!arguments.length){d=1;g=j=a=0;c=1;h=0}f.zoomFraction=function(m){if(!arguments.length)return o;o=m;k=Math.floor(o+Math.log(Math.sqrt(d*d+g*g+a*a+c*c))/Math.log(2));r=Math.pow(2,-k);return f};f.apply=function(m){var n=Math.pow(2,-m.zoom),w=Math.pow(2,m.zoom-k);return{column:(d*m.column*n+a*m.row*n+j)*w,row:(g*m.column*n+c*m.row*n+h)*w,zoom:m.zoom-k}};f.unapply=function(m){var n=
Math.pow(2,-m.zoom),w=Math.pow(2,m.zoom+k);return{column:(m.column*n*c-m.row*n*a-j*c+h*a)/(d*c-g*a)*w,row:(m.column*n*g-m.row*n*d-j*g+h*d)/(a*g-c*d)*w,zoom:m.zoom+k}};f.toString=function(){return"matrix("+[d*r,g*r,a*r,c*r].join(" ")+" 0 0)"};return f.zoomFraction(0)};q.cache=function(d,g){function a(n){m--;g&&g(n);delete f[n.key];if(n.next)n.next.prev=n.prev;else if(o=n.prev)o.next=null;if(n.prev)n.prev.next=n.next;else if(k=n.next)k.prev=null}function c(){for(var n=o;m>r;n=n.prev){if(!n)break;n.lock||
a(n)}}var j={},h={},f={},k=null,o=null,r=64,m=0;j.peek=function(n){return f[[n.zoom,n.column,n.row].join("/")]};j.load=function(n,w){var e=[n.zoom,n.column,n.row].join("/"),l=f[e];if(l){if(l.prev){if(l.prev.next=l.next)l.next.prev=l.prev;else o=l.prev;l.prev=null;l.next=k;k=k.prev=l}l.lock=1;return h[e]=l}l={key:e,column:n.column,row:n.row,zoom:n.zoom,next:k,prev:null,lock:1};d.call(null,l,w);h[e]=f[e]=l;if(k)k.prev=l;else o=l;k=l;m++;c();return l};j.unload=function(n){if(!(n in h))return false;var w=
h[n];w.lock=0;delete h[n];w.request&&w.request.abort(false)?a(w):c();return w};j.locks=function(){return h};j.size=function(n){if(!arguments.length)return r;r=n;c();return j};return j};q.url=function(d){function g(c){var j=c.zoom<0?1:1<<c.zoom,h=c.column%j;if(h<0)h+=j;return d.replace(/{(.)}/g,function(f,k){switch(k){case "S":return a[(Math.abs(c.zoom)+c.row+h)%a.length];case "Z":return c.zoom;case "X":return h;case "Y":return c.row;case "B":var o=q.map.coordinateLocation({row:c.row,column:h,zoom:c.zoom}),
r=q.map.coordinateLocation({row:c.row+1,column:h+1,zoom:c.zoom}),m=Math.ceil(Math.log(c.zoom)/Math.LN2);return r.lat.toFixed(m)+","+o.lon.toFixed(m)+","+o.lat.toFixed(m)+","+r.lon.toFixed(m)}return k})}var a=[];g.template=function(c){if(!arguments.length)return d;d=c;return g};g.hosts=function(c){if(!arguments.length)return a;a=c;return g};return g};q.dispatch=function(d){var g={};d.on=function(a,c){for(var j=g[a]||(g[a]=[]),h=0;h<j.length;h++)if(j[h].handler==c)return d;j.push({handler:c,on:true});
return d};d.off=function(a,c){var j=g[a];if(j)for(var h=0;h<j.length;h++){var f=j[h];if(f.handler==c){f.on=false;j.splice(h,1);break}}return d};return function(a){var c=g[a.type];if(c){c=c.slice();for(var j=0;j<c.length;j++){var h=c[j];h.on&&h.handler.call(d,a)}}}};q.queue=function(){function d(){if(!(j>=h||!c.length)){j++;c.pop()()}}function g(f){for(var k=0;k<c.length;k++)if(c[k]==f){c.splice(k,1);return true}return false}function a(f,k,o){function r(){m=new XMLHttpRequest;o&&m.overrideMimeType(o);
m.open("GET",f,true);m.onreadystatechange=function(){if(m.readyState==4){j--;m.status<300&&k(m);d()}};m.send(null)}var m;c.push(r);d();return{abort:function(n){if(g(r))return true;if(n&&m){m.abort();return true}return false}}}var c=[],j=0,h=6;return{text:function(f,k,o){return a(f,function(r){r.responseText&&k(r.responseText)},o)},xml:function(f,k){return a(f,function(o){o.responseXML&&k(o.responseXML)},"application/xml")},json:function(f,k){return a(f,function(o){o.responseText&&k(JSON.parse(o.responseText))},
"application/json")},image:function(f,k,o){function r(){m=document.createElement("img");m.onerror=function(){j--;d()};m.onload=function(){j--;o(m);d()};m.src=k;f.setAttributeNS(q.ns.xlink,"href",k)}var m;c.push(r);d();return{abort:function(n){if(g(r))return true;if(n&&m){m.src="about:";return true}return false}}}}}();q.map=function(){function d(){if(w)if(r<w[0])r=w[0];else if(r>w[1])r=w[1];m=r-(r=Math.round(r));n=Math.pow(2,m)}function g(){if(G){var i=45/Math.pow(2,r+m-3),y=Math.max(Math.abs(s*f.x+
l*f.y),Math.abs(t*f.x+v*f.y)),x=Q(D-y*i/k.y);y=Q(L+y*i/k.y);o.lat=Math.max(x,Math.min(y,o.lat));x=Math.max(Math.abs(s*f.y+l*f.x),Math.abs(t*f.y+v*f.x));o.lon=Math.max(G[0].lon-x*i/k.x,Math.min(G[1].lon+x*i/k.x,o.lon))}}var a={},c,j,h=S,f=S,k={x:256,y:256},o={lat:37.76487,lon:-122.41948},r=12,m=0,n=1,w=[1,18],e=0,l=1,s=0,v=1,t=0,D=-180,L=180,G=[{lat:Q(D),lon:-Infinity},{lat:Q(L),lon:Infinity}];a.locationCoordinate=function(i){i=q.map.locationCoordinate(i);var y=Math.pow(2,r);i.column*=y;i.row*=y;i.zoom+=
r;return i};a.coordinateLocation=q.map.coordinateLocation;a.coordinatePoint=function(i,y){var x=Math.pow(2,r-y.zoom),F=Math.pow(2,r-i.zoom),I=(y.column*x-i.column*F)*k.x*n;x=(y.row*x-i.row*F)*k.y*n;return{x:f.x+l*I-s*x,y:f.y+s*I+l*x}};a.pointCoordinate=function(i,y){var x=Math.pow(2,r-i.zoom),F=(y.x-f.x)/n,I=(y.y-f.y)/n;return{column:i.column*x+(v*F-t*I)/k.x,row:i.row*x+(t*F+v*I)/k.y,zoom:r}};a.locationPoint=function(i){var y=Math.pow(2,r+m-3)/45,x=(i.lon-o.lon)*y*k.x;i=(R(o.lat)-R(i.lat))*y*k.y;
return{x:f.x+l*x-s*i,y:f.y+s*x+l*i}};a.pointLocation=function(i){var y=45/Math.pow(2,r+m-3),x=(i.x-f.x)*y;i=(i.y-f.y)*y;return{lon:o.lon+(v*x-t*i)/k.x,lat:Q(R(o.lat)-(t*x+v*i)/k.y)}};var C=q.svg("rect");C.setAttribute("visibility","hidden");C.setAttribute("pointer-events","all");a.container=function(i){if(!arguments.length)return c;c=i;c.setAttribute("class","map");c.appendChild(C);return a.resize()};a.focusableParent=function(){for(var i=c;i;i=i.parentNode)if(i.tabIndex>=0)return i;return window};
a.mouse=function(i){var y=(c.ownerSVGElement||c).createSVGPoint();if(V<0&&(window.scrollX||window.scrollY)){var x=document.body.appendChild(q.svg("svg"));x.style.position="absolute";x.style.top=x.style.left="0px";var F=x.getScreenCTM();V=!(F.f||F.e);document.body.removeChild(x)}if(V){y.x=i.pageX;y.y=i.pageY}else{y.x=i.clientX;y.y=i.clientY}return y.matrixTransform(c.getScreenCTM().inverse())};a.size=function(i){if(!arguments.length)return h;j=i;return a.resize()};a.resize=function(){if(j){h=j;M.remove(a)}else{var i=
c.ownerSVGElement||c;if(i.offsetWidth==null){C.setAttribute("width","100%");C.setAttribute("height","100%");i=C}b=i.getBoundingClientRect();h={x:b.width,y:b.height};M.add(a)}C.setAttribute("width",h.x);C.setAttribute("height",h.y);f={x:h.x/2,y:h.y/2};g();a.dispatch({type:"resize"});return a};a.tileSize=function(i){if(!arguments.length)return k;k=i;a.dispatch({type:"move"});return a};a.center=function(i){if(!arguments.length)return o;o=i;g();a.dispatch({type:"move"});return a};a.panBy=function(i){var y=
45/Math.pow(2,r+m-3),x=i.x*y;i=i.y*y;return a.center({lon:o.lon+(t*i-v*x)/k.x,lat:Q(R(o.lat)+(t*x+v*i)/k.y)})};a.centerRange=function(i){if(!arguments.length)return G;if(G=i){D=G[0].lat>-90?R(G[0].lat):-Infinity;L=G[0].lat<90?R(G[1].lat):Infinity}else{D=-Infinity;L=Infinity}g();a.dispatch({type:"move"});return a};a.zoom=function(i){if(!arguments.length)return r+m;r=i;d();return a.center(o)};a.zoomBy=function(i,y,x){if(arguments.length<2)return a.zoom(r+m+i);if(arguments.length<3)x=a.pointLocation(y);
r=r+m+i;d();var F=a.locationPoint(x);return a.panBy({x:y.x-F.x,y:y.y-F.y})};a.zoomRange=function(i){if(!arguments.length)return w;w=i;return a.zoom(r+m)};a.angle=function(i){if(!arguments.length)return e;e=i;l=Math.cos(e);s=Math.sin(e);v=Math.cos(-e);t=Math.sin(-e);g();a.dispatch({type:"move"});return a};a.add=function(i){i.map(a);return a};a.remove=function(i){i.map(null);return a};a.dispatch=q.dispatch(a);return a};M.maps=[];M.add=function(d){for(var g=0;g<M.maps.length;g++)if(M.maps[g]==d)return;
M.maps.push(d)};M.remove=function(d){for(var g=0;g<M.maps.length;g++)if(M.maps[g]==d){M.maps.splice(g,1);return}};window.addEventListener("resize",M,false);q.map.locationCoordinate=function(d){var g=1/360;return{column:(d.lon+180)*g,row:(180-R(d.lat))*g,zoom:0}};q.map.coordinateLocation=function(d){var g=45/Math.pow(2,d.zoom-3);return{lon:g*d.column-180,lat:Q(180-g*d.row)}};var V=/WebKit/.test(navigator.userAgent)?-1:0;q.layer=function(d,g){function a(){function e(u){var z=u.zoom,A=z<0?1:1<<z,B=u.column%
A,H=u.row;if(B<0)B+=A;return{locationPoint:function(J){J=q.map.locationCoordinate(J);var K=Math.pow(2,z-J.zoom);return{x:G.x*(K*J.column-B),y:G.y*(K*J.row-H)}}}}function l(u,z,A){var B=y.zoom,H=2-F,J=4+F;for(u=u;u<z;u++){var K=j.load({column:u,row:A,zoom:B},e);if(!K.ready&&!(K.key in I)){K.proxyRefs={};for(var P,T,N,O=1;O<=H;O++){T=true;for(var W=0,aa=1<<O;W<=aa;W++)for(var X=0;X<=aa;X++)if((N=j.peek(P={column:(u<<O)+X,row:(A<<O)+W,zoom:B+O}))&&N.ready){I[N.key]=j.load(P);N.proxyCount++;K.proxyRefs[N.key]=
N}else T=false;if(T)break}if(!T)for(O=1;O<=J;O++)if((N=j.peek(P={column:u>>O,row:A>>O,zoom:B-O}))&&N.ready){I[N.key]=j.load(P);N.proxyCount++;K.proxyRefs[N.key]=N;break}}I[K.key]=K}}var s=c.map(),v=s.zoom(),t=v-(v=Math.round(v)),D=s.size(),L=s.angle(),G=s.tileSize(),C=s.locationCoordinate(s.center());f?m.removeAttribute("visibility"):m.setAttribute("visibility","hidden");for(var i=-4;i<=2;i++)w[i].setAttribute("class","zoom"+(i<0?"":"+")+i+" zoom"+(v+i));m.setAttribute("transform","translate("+D.x/
2+","+D.y/2+")"+(L?"rotate("+L/Math.PI*180+")":"")+(t?"scale("+Math.pow(2,t)+")":"")+(n?n.zoomFraction(t):""));var y=s.pointCoordinate(C,S);i=s.pointCoordinate(C,{x:D.x,y:0});var x=s.pointCoordinate(C,D);s=s.pointCoordinate(C,{x:0,y:D.y});if(!t&&!L&&!n){C.column=(Math.round(G.x*C.column)+(D.x&1)/2)/G.x;C.row=(Math.round(G.y*C.row)+(D.y&1)/2)/G.y}var F=k?k(v)-v:0;if(F){t=Math.pow(2,F);y.column*=t;y.row*=t;i.column*=t;i.row*=t;x.column*=t;x.row*=t;s.column*=t;s.row*=t;y.zoom=i.zoom=x.zoom=s.zoom+=F}if(n){y=
n.unapply(y);i=n.unapply(i);x=n.unapply(x);s=n.unapply(s);C=n.unapply(C)}v=j.locks();var I={};for(var E in v)v[E].proxyCount=0;if(f&&F>-5&&F<3){t=y.zoom<0?1:1<<y.zoom;if(h){$(y,i,x,0,t,l);$(x,s,y,0,t,l)}else{x=Math.floor((y.column+x.column)/2);s=Math.max(0,Math.min(t-1,Math.floor((i.row+s.row)/2)));i=Math.min(4,y.zoom);x=x>>i<<i;s=s>>i<<i;l(x,x+1,s)}}for(E in I){i=I[E];t=Math.pow(2,i.level=i.zoom-C.zoom);x=G.x*(i.column-C.column*t);s=G.y*(i.row-C.row*t);i.element.setAttribute("transform","translate("+
x+","+s+")")}for(E in v)if(!(E in I)){i=j.unload(E);i.element.parentNode.removeChild(i.element);delete i.proxyRefs}for(E in I){i=I[E];if(i.element.parentNode!=w[i.level]){w[i.level].appendChild(i.element);c.show&&c.show(i)}}}var c={},j=c.cache=q.cache(d,g).size(512),h=true,f=true,k,o,r,m,n,w;c.map=function(e){if(!arguments.length)return r;if(r){if(r==e){m.parentNode.appendChild(m);return c}r.off("move",a).off("resize",a);m.parentNode.removeChild(m);m=w=null}if(r=e){m=r.container().appendChild(q.svg("g"));
o&&m.setAttribute("id",o);m.setAttribute("class","layer");w={};for(var l=-4;l<=-1;l++)(w[l]=m.appendChild(q.svg("g"))).setAttribute("transform","scale("+Math.pow(2,-l)+")");for(l=2;l>=1;l--)(w[l]=m.appendChild(q.svg("g"))).setAttribute("transform","scale("+Math.pow(2,-l)+")");w[0]=m.appendChild(q.svg("g"));c.init&&c.init(m);r.on("move",a).on("resize",a);a()}return c};c.container=function(){return m};c.id=function(e){if(!arguments.length)return o;o=e;return c};c.visible=function(e){if(!arguments.length)return f;
f=e;r&&a();return c};c.transform=function(e){if(!arguments.length)return n;n=e;r&&a();return c};c.zoom=function(e){if(!arguments.length)return k;k=typeof e=="function"||e==null?e:function(){return e};return c};c.tile=function(e){if(!arguments.length)return h;h=e;return c};c.dispatch=q.dispatch(c);c.on("load",function(e){if(e.tile.proxyRefs){for(var l in e.tile.proxyRefs){var s=e.tile.proxyRefs[l];--s.proxyCount<=0&&j.unload(l)&&s.element.parentNode.removeChild(s.element)}delete e.tile.proxyRefs}});
return c};q.image=function(){var d=q.layer(function(a){var c=a.element=q.svg("image"),j=d.map().tileSize();c.setAttribute("preserveAspectRatio","none");c.setAttribute("width",j.x);c.setAttribute("height",j.y);c.setAttribute("opacity",0);if(typeof g=="function")a.request=q.queue.image(c,g(a),function(){delete a.request;a.ready=true;c.removeAttribute("opacity");d.dispatch({type:"load",tile:a})});else{a.ready=true;c.setAttributeNS(q.ns.xlink,"href",g);d.dispatch({type:"load",tile:a})}},function(a){a.request&&
a.request.abort(true)}),g="about:blank";d.url=function(a){if(!arguments.length)return g;g=typeof a=="string"&&/{.}/.test(a)?q.url(a):a;return d};return d};q.geoJson=function(d){function g(e,l){return e&&e.type in w&&w[e.type](e,l)}function a(e,l){var s=l({lat:e[1],lon:e[0]}),v=q.svg("circle");v.setAttribute("r",4.5);v.setAttribute("cx",s.x);v.setAttribute("cy",s.y);return v}function c(e,l,s,v){v.push("M");for(var t=0;t<e.length-l;t++){p=s({lat:e[t][1],lon:e[t][0]});v.push(p.x);v.push(",");v.push(p.y);
v.push("L")}v.pop()}function j(e,l,s,v){for(var t=0;t<e.length;t++)c(e[t],l,s,v);l&&v.push("Z")}function h(e,l,s,v){for(var t=[],D=0;D<l.length;D++)e(l[D],s,v,t);if(t.length){e=q.svg("path");e.setAttribute("d",t.join(""));return e}}var f=q.layer(function(e,l){function s(t){var D=[];if(t.next)e.request=d(t.next.href,s);switch(t.type){case "FeatureCollection":for(var L=0;L<t.features.length;L++){var G=t.features[L],C=g(G.geometry,l.locationPoint);C&&D.push({element:v.appendChild(C),data:G})}break;case "Feature":(C=
g(t.geometry,l.locationPoint))&&D.push({element:v.appendChild(C),data:t});break;default:(C=g(t,l.locationPoint))&&D.push({element:v.appendChild(C),data:{type:"Feature",geometry:t}});break}e.ready=true;D.push.apply(m[e.key]||(m[e.key]=[]),D);f.dispatch({type:"load",tile:e,features:D})}var v=e.element=q.svg("g");l=l(e);if(n)s({type:"FeatureCollection",features:n});else e.request=d(typeof k=="function"?k(e):k,s);r&&v.setAttribute("clip-path","url(#"+r+")")},function(e){e.request&&e.request.abort(true);
delete m[e.key]}),k="about:blank",o=true,r,m={},n;if(!arguments.length)d=q.queue.json;var w={Point:function(e,l){return a(e.coordinates,l)},MultiPoint:function(e,l){for(var s=q.svg("g"),v=0;v<e.coordinates.length;v++)s.appendChild(a(e.coordinates[v],l));return s},LineString:function(e,l){return h(c,[e.coordinates],0,l)},MultiLineString:function(e,l){return h(c,e.coordinates,0,l)},Polygon:function(e,l){return h(j,[e.coordinates],1,l)},MultiPolygon:function(e,l){return h(j,e.coordinates||e.coords,1,
l)},GeometryCollection:function(e,l){for(var s=q.svg("g"),v=0;v<e.geometries.length;v++){var t=g(e.geometries[v],l);t&&s.appendChild(t)}return s}};f.url=function(e){if(!arguments.length)return k;k=typeof e=="string"&&/{.}/.test(e)?q.url(e):e;typeof k=="string"&&f.tile(false);return f};f.features=function(e){if(!arguments.length)return n;e&&f.tile(false);n=e;return f};f.clip=function(e){if(!arguments.length)return o;o=e;return f};f.init=function(e){if(o&&f.tile()){var l=f.map().tileSize(),s=e.insertBefore(q.svg("clipPath"),
e.firstChild),v=s.appendChild(q.svg("rect"));s.setAttribute("id",r="org.polymaps."+q.id());v.setAttribute("width",l.x);v.setAttribute("height",l.y)}e.setAttribute("fill-rule","evenodd")};f.show=function(e){f.dispatch({type:"show",tile:e,features:m[e.key]||[]})};f.reshow=function(){var e=f.cache.locks();for(var l in e)f.show(e[l])};return f};q.dblclick=function(){function d(h){var f=c.zoom();f=h.shiftKey?Math.ceil(f)-f-1:1-f+Math.floor(f);a==="mouse"?c.zoomBy(f,c.mouse(h)):c.zoomBy(f)}var g={},a="mouse",
c,j;g.zoom=function(h){if(!arguments.length)return a;a=h;return g};g.map=function(h){if(!arguments.length)return c;if(c){j.removeEventListener("dblclick",d,false);j=null}if(c=h){j=c.container();j.addEventListener("dblclick",d,false)}return g};return g};q.drag=function(){function d(k){f={x:k.clientX,y:k.clientY};c.focusableParent().focus();k.preventDefault();h=document.body.style.cursor;document.body.style.cursor="move"}function g(k){if(f){c.panBy({x:k.clientX-f.x,y:k.clientY-f.y});f.x=k.clientX;f.y=
k.clientY}}var a={},c,j,h,f;a.map=function(k){if(!arguments.length)return c;if(c){j.removeEventListener("mousedown",d,false);j=null}if(c=k){j=c.container();j.addEventListener("mousedown",d,false)}return a};window.addEventListener("mousemove",g,false);window.addEventListener("mouseup",function(k){if(f){g(k);f=null;document.body.style.cursor=h}},false);return a};q.wheel=function(){function d(){k=null}function g(m){var n=(m.wheelDelta/120||-m.detail)*0.1,w=o.mouse(m);if(Y<0){var e=Date.now(),l=e-j;if(l>
9&&Math.abs(m.wheelDelta)/l>=50)Y=1;j=e}if(Y==1)n*=0.03;k||(k=o.pointLocation(w));o.off("move",d);if(h)f==="mouse"?o.zoomBy(n,w,k):o.zoomBy(n);else if(n){e=Date.now();if(e-c>200){n=n>0?+1:-1;f==="mouse"?o.zoomBy(n,w,k):o.zoomBy(n);c=e}}o.on("move",d);m.preventDefault();return false}var a={},c=0,j=0,h=true,f="mouse",k,o,r;a.smooth=function(m){if(!arguments.length)return h;h=m;return a};a.zoom=function(m){if(!arguments.length)return f;f=m;return a};a.map=function(m){if(!arguments.length)return o;if(o){r.removeEventListener("mousemove",
d,false);r.removeEventListener("mousewheel",g,false);r.removeEventListener("DOMMouseScroll",g,false);r=null;o.off("move",d)}if(o=m){o.on("move",d);r=o.container();r.addEventListener("mousemove",d,false);r.addEventListener("mousewheel",g,false);r.addEventListener("DOMMouseScroll",g,false)}return a};return a};var Y=/WebKit\/533/.test(navigator.userAgent)?-1:0;q.arrow=function(){function d(e){if(!(e.ctrlKey||e.altKey||e.metaKey)){var l=Date.now(),s=0,v=0;switch(e.keyCode){case 37:if(!h.left){f=l;h.left=
1;h.right||(s=m)}break;case 39:if(!h.right){f=l;h.right=1;h.left||(s=-m)}break;case 38:if(!h.up){f=l;h.up=1;h.down||(v=m)}break;case 40:if(!h.down){f=l;h.down=1;h.up||(v=-m)}break;default:return}if(s||v)n.panBy({x:s,y:v});if(!k&&h.left|h.right|h.up|h.down)k=setInterval(c,r);e.preventDefault()}}function g(e){f=Date.now();switch(e.keyCode){case 37:h.left=0;break;case 39:h.right=0;break;case 38:h.up=0;break;case 40:h.down=0;break;default:return}if(k&&!(h.left|h.right|h.up|h.down))k=clearInterval(k);
e.preventDefault()}function a(e){switch(e.charCode){case 45:case 95:n.zoom(Math.ceil(n.zoom())-1);break;case 43:case 61:n.zoom(Math.floor(n.zoom())+1);break;default:return}e.preventDefault()}function c(){if(n)if(!(Date.now()<f+o)){var e=(h.left-h.right)*m,l=(h.up-h.down)*m;if(e||l)n.panBy({x:e,y:l})}}var j={},h={left:0,right:0,up:0,down:0},f=0,k,o=250,r=50,m=16,n,w;j.map=function(e){if(!arguments.length)return n;if(n){w.removeEventListener("keypress",a,false);w.removeEventListener("keydown",d,false);
w.removeEventListener("keyup",g,false);w=null}if(n=e){w=n.focusableParent();w.addEventListener("keypress",a,false);w.addEventListener("keydown",d,false);w.addEventListener("keyup",g,false)}return j};j.speed=function(e){if(!arguments.length)return m;m=e;return j};return j};q.hash=function(){function d(){var f=h.center(),k=h.zoom(),o=Math.max(0,Math.ceil(Math.log(k)/Math.LN2));f="#"+k.toFixed(2)+"/"+f.lat.toFixed(o)+"/"+f.lon.toFixed(o);if(c!==f)location.replace(c=f)}function g(){if(location.hash!==
c){var f=(c=location.hash).substring(1).split("/").map(Number);if(f.length<3||f.some(isNaN))d();else{var k=h.size();h.zoomBy(f[0]-h.zoom(),{x:k.x/2,y:k.y/2},{lat:Math.min(j,Math.max(-j,f[1])),lon:f[2]})}}}var a={},c,j=89.99999999,h;a.map=function(f){if(!arguments.length)return h;if(h){h.off("move",d);window.removeEventListener("hashchange",g,false)}if(h=f){h.on("move",d);window.addEventListener("hashchange",g,false);location.hash?g():d()}return a};return a};q.interact=function(){var d={},g=q.drag(),
a=q.wheel(),c=q.dblclick(),j=q.arrow();d.map=function(h){g.map(h);a.map(h);c.map(h);j.map(h);return d};return d};q.compass=function(){function d(u){s.setAttribute("class","compass active");F||(F=setInterval(g,C));I&&E.panBy(I);L=Date.now();return o(u)}function g(){I&&Date.now()>L+G&&E.panBy(I)}function a(){s.setAttribute("class","compass");if(F){clearInterval(F);F=0}}function c(u){return function(){u?this.setAttribute("class","active"):this.removeAttribute("class");I=u}}function j(u){return function(z){s.setAttribute("class",
"compass active");var A=E.zoom();E.zoom(u<0?Math.ceil(A)-1:Math.floor(A)+1);return o(z)}}function h(u){return function(z){E.zoom(u);return o(z)}}function f(){this.setAttribute("class","active")}function k(){this.removeAttribute("class")}function o(u){u.stopPropagation();u.preventDefault();return false}function r(u){var z=Math.SQRT1_2*t,A=t*0.7,B=t*0.2,H=q.svg("g"),J=H.appendChild(q.svg("path")),K=H.appendChild(q.svg("path"));J.setAttribute("class","direction");J.setAttribute("pointer-events","all");
J.setAttribute("d","M0,0L"+z+","+z+"A"+t+","+t+" 0 0,1 "+-z+","+z+"Z");K.setAttribute("class","chevron");K.setAttribute("d","M"+B+","+(A-B)+"L0,"+A+" "+-B+","+(A-B));K.setAttribute("pointer-events","none");H.addEventListener("mousedown",d,false);H.addEventListener("mouseover",c(u),false);H.addEventListener("mouseout",c(null),false);H.addEventListener("dblclick",o,false);return H}function m(u){var z=t*0.4,A=z/2,B=q.svg("g"),H=B.appendChild(q.svg("path")),J=B.appendChild(q.svg("path")),K=B.appendChild(q.svg("path")),
P=B.appendChild(q.svg("path"));H.setAttribute("class","back");H.setAttribute("d","M"+-z+",0V"+-z+"A"+z+","+z+" 0 1,1 "+z+","+-z+"V0Z");J.setAttribute("class","direction");J.setAttribute("d",H.getAttribute("d"));K.setAttribute("class","chevron");K.setAttribute("d","M"+-A+","+-z+"H"+A+(u>0?"M0,"+(-z-A)+"V"+-A:""));P.setAttribute("class","fore");P.setAttribute("fill","none");P.setAttribute("d",H.getAttribute("d"));B.addEventListener("mousedown",j(u),false);B.addEventListener("mouseover",f,false);B.addEventListener("mouseout",
k,false);B.addEventListener("dblclick",o,false);return B}function n(u){var z=t*0.2,A=t*0.4,B=q.svg("g"),H=B.appendChild(q.svg("rect")),J=B.appendChild(q.svg("path"));H.setAttribute("pointer-events","all");H.setAttribute("fill","none");H.setAttribute("x",-A);H.setAttribute("y",-0.75*A);H.setAttribute("width",2*A);H.setAttribute("height",1.5*A);J.setAttribute("class","chevron");J.setAttribute("d","M"+-z+",0H"+z);B.addEventListener("mousedown",h(u),false);B.addEventListener("dblclick",o,false);return B}
function w(){var u=t+6,z=u,A=E.size();switch(i){case "top-left":break;case "top-right":u=A.x-u;break;case "bottom-left":z=A.y-z;break;case "bottom-right":u=A.x-u;z=A.y-z;break}s.setAttribute("transform","translate("+u+","+z+")");for(var B in v)B==E.zoom()?v[B].setAttribute("class","active"):v[B].removeAttribute("class")}function e(){for(;s.lastChild;)s.removeChild(s.lastChild);if(x!="none"){var u=s.appendChild(q.svg("g"));u.setAttribute("class","pan");var z=u.appendChild(q.svg("circle"));z.setAttribute("class",
"back");z.setAttribute("r",t);u.appendChild(r({x:0,y:-D})).setAttribute("transform","rotate(0)");u.appendChild(r({x:D,y:0})).setAttribute("transform","rotate(90)");u.appendChild(r({x:0,y:D})).setAttribute("transform","rotate(180)");u.appendChild(r({x:-D,y:0})).setAttribute("transform","rotate(270)");u=u.appendChild(q.svg("circle"));u.setAttribute("fill","none");u.setAttribute("class","fore");u.setAttribute("r",t)}if(y!="none"){u=s.appendChild(q.svg("g"));u.setAttribute("class","zoom");z=-0.5;if(y==
"big"){v={};var A=E.zoomRange()[0];for(z=0;A<=E.zoomRange()[1];A++,z++)(v[A]=u.appendChild(n(A))).setAttribute("transform","translate(0,"+-(z+0.75)*t*0.4+")")}A=x=="none"?0.4:2;u.setAttribute("transform","translate(0,"+t*(/^top-/.test(i)?A+(z+0.5)*0.4:-A)+")");u.appendChild(m(+1)).setAttribute("transform","translate(0,"+-(z+0.5)*t*0.4+")");u.appendChild(m(-1)).setAttribute("transform","scale(-1)")}w()}var l={},s=q.svg("g"),v={},t=30,D=16,L=0,G=250,C=50,i="top-left",y="small",x="small",F,I,E;s.setAttribute("class",
"compass");l.radius=function(u){if(!arguments.length)return t;t=u;E&&e();return l};l.speed=function(u){if(!arguments.length)return t;D=u;return l};l.position=function(u){if(!arguments.length)return i;i=u;E&&e();return l};l.pan=function(u){if(!arguments.length)return x;x=u;E&&e();return l};l.zoom=function(u){if(!arguments.length)return y;y=u;E&&e();return l};l.map=function(u){if(!arguments.length)return E;if(E){s.parentNode.removeChild(s);E.off("move",w).off("resize",w);window.removeEventListener("mouseup",
a,false)}if(E=u){window.addEventListener("mouseup",a,false);E.on("move",w).on("resize",w);E.container().appendChild(s);e()}return l};return l};q.grid=function(){function d(){var j=c.firstChild,h=a.size(),f=a.pointLocation(S);a.pointLocation(h);var k=Math.pow(2,4-Math.round(a.zoom()));f.lat=Math.floor(f.lat/k)*k;f.lon=Math.ceil(f.lon/k)*k;for(var o;(o=a.locationPoint(f).x)<=h.x;f.lon+=k){j||(j=c.appendChild(q.svg("line")));j.setAttribute("x1",o);j.setAttribute("x2",o);j.setAttribute("y1",0);j.setAttribute("y2",
h.y);j=j.nextSibling}for(;(o=a.locationPoint(f).y)<=h.y;f.lat-=k){j||(j=c.appendChild(q.svg("line")));j.setAttribute("y1",o);j.setAttribute("y2",o);j.setAttribute("x1",0);j.setAttribute("x2",h.x);j=j.nextSibling}for(;j;){h=j.nextSibling;c.removeChild(j);j=h}}var g={},a,c=q.svg("g");c.setAttribute("class","grid");g.map=function(j){if(!arguments.length)return a;if(a){c.parentNode.removeChild(c);a.off("move",d).off("resize",d)}if(a=j){a.on("move",d).on("resize",d);a.container().appendChild(c);a.dispatch({type:"move"})}return g};
return g}})(org.polymaps);
